# shopApplication

## Description
REST API for shop application.

#### Database
Catalog 'database' contain database scheme and sample data. Entity classes are generated by NetBeans environment based to previously created database.
To start the application you have to create database before and edit 'persistence.xml' file, add correct:
- jdbc.url
- jdbc.user
- jdbc.password
Database was created on MySQL Server.

#### Tests
Application has tests that has to be passed to build project.

### API description

#### Book
Data about books in shop.
  - [GET /books](#get-books)
  - [GET /books/[id]](#get-booksid)
  - [POST /books/book](#post-books)
  - [PUT /books/book](#put-books)
  - [DELETE /books/book](#delete-books)

##### GET /books

Example: http://localhost:8080/books

Response body:

```
[
  {
    id: 1,
    title: "Lalka",
    author: "Bolesław Prus",
    pagesCount: 859,
    price: 49.97,
    count: 1,
    idUser: 1
  },
  {
    id: 2,
    title: "Stary czlowiek i morze",
    author: "Ernest Hemingway",
    pagesCount: 90,
    price: 19.99,
    count: 1,
    idUser: 2
  }
] 
  ```
  
##### GET /books/[id]

Example: http://localhost:8080/books/1

Response body:

```
{
    "id": 1,
    "title": "Lalka",
    "author": "Bolesław Prus",
    "pagesCount": 859,
    "price": 49.97,
    "count": 1,
    "idUser": 1
}
  ```
  
##### POST /books

Example: http://localhost:8080/books

Request body:

```
{
    "id": null,
    "title": "Krzyżacy",
    "author": "Sienkiewicz",
    "pagesCount": 300,
    "price": 19.97,
    "count": 1,
    "idUser": 2
}
  ```
  
##### PUT /books

Example: http://localhost:8080/books

Request body:

```
{
    "id": 19,
    "title": "Dziady",
    "author": "Mickiewicz",
    "pagesCount": 300,
    "price": 19.97,
    "count": 1,
    "idUser": 2
}
  ```
  
##### DELETE /books

Example: http://localhost:8080/books

Request body:

```
{
    "id": 19,
    "title": "Dziady",
    "author": "Mickiewicz",
    "pagesCount": 300,
    "price": 19.97,
    "count": 1,
    "idUser": 2
}
  ```

#### OrderData
Data about submitted orders.
  - [GET /orderData](#get-orderData)
  - [GET /orderData/[id]](#get-orderDataid)
  - [POST /orderData/orderData](#post-orderData)
  - [PUT /orderData/orderData](#put-orderData)
  - [DELETE /orderData/orderData](#delete-orderData)
  
Record will be saved or updated in database if:
- all taken items are available
- there is at least one item in order
- there are not duplicates in order
- total cost of order is higher than 29.0

##### GET /orderData

Example: http://localhost:8080/orderData

Response body:

```
[
    {
    "id": 19,
    "orderDate": "2020-01-01",
    "payMethod": "card",
    "deliveryMethod": "delivery",
    "userOrderCollection": [
        {
            "id": 6,
            "count": 1,
            "book": {
                "id": 1,
                "title": "Lalka",
                "author": "Bolesław Prus",
                "pagesCount": 600,
                "price": 29.99,
                "count": 100,
                "idUser": 1
            }
        },
        {
            "id": 7,
            "count": 1,
            "book": {
                "id": 2,
                "title": "Stary czlowiek i morze",
                "author": "Ernest Hemingway",
                "pagesCount": 90,
                "price": 19.99,
                "count": 50,
                "idUser": 2
            }
        }
    ],
    "idUser": 1
  }
]
  ```
  
##### GET /orderData/[id]

Example: http://localhost:8080/orderData/1

Response body:

```
{
    "id": 1,
    "orderDate": "2020-01-01",
    "payMethod": "card",
    "deliveryMethod": "delivery",
    "userOrderCollection": [
        {
            "id": 6,
            "count": 1,
            "book": {
                "id": 1,
                "title": "Lalka",
                "author": "Bolesław Prus",
                "pagesCount": 600,
                "price": 29.99,
                "count": 100,
                "idUser": 1
            }
        }
    ],
    "idUser": 1
}
  ```
  
##### POST /orderData

Example: http://localhost:8080/orderData

Request body:

```
{
    "id": null,
    "orderDate": "2020-01-01",
    "payMethod": "card",
    "deliveryMethod": "delivery",
    "userOrderCollection": [
        {
            "id": null,
            "count": 1,
            "book": {
                "id": 1,
                "title": "Lalka",
                "author": "Bolesław Prus",
                "pagesCount": 600,
                "price": 29.99,
                "count": 100,
                "idUser": 1
            }
        },
        {
            "id": null,
            "idBook": 1,
            "idOrder": null,
            "count": 1,
            "book": {
                "id": 2,
                "title": "Stary czlowiek i morze",
                "author": "Ernest Hemingway",
                "pagesCount": 90,
                "price": 19.99,
                "count": 50,
                "idUser": 2
            }
        }
    ],
    "idUser": 1
}
```
  
##### PUT /orderData

Example: http://localhost:8080/orderData

Request body:

```
{
    "id": 1,
    "orderDate": "2020-01-01",
    "payMethod": "card",
    "deliveryMethod": "delivery",
    "userOrderCollection": [
        {
            "id": 1,
            "count": 1,
            "book": {
                "id": 1,
                "title": "Lalka",
                "author": "Bolesław Prus",
                "pagesCount": 600,
                "price": 29.99,
                "count": 100,
                "idUser": 1
            }
        },
        {
            "id": 2,
            "count": 1,
            "book": {
                "id": 2,
                "title": "Stary czlowiek i morze",
                "author": "Ernest Hemingway",
                "pagesCount": 90,
                "price": 19.99,
                "count": 50,
                "idUser": 2
            }
        }
    ],
    "idUser": 1
}
```
  
##### DELETE /orderData

Example: http://localhost:8080/orderData

Request body:

```

  ```


#### UserData
Data about users.
  - [GET /userData](#get-userData)
  - [GET /userData/[id]](#get-userDataid)
  - [POST /userData/userData](#post-userData)
  - [PUT /userData/userData](#put-userData)
  - [DELETE /userData/userData](#delete-userData)
  
##### GET /userData

Example: http://localhost:8080/userData

Response body:

```
[
    {
        "id": 1,
        "email": "sebastian@wp.pl",
        "firstName": "Sebastian",
        "lastName": "Kasa",
        "city": "Gdansk",
        "postalCode": "80-000",
        "street": "Grunwaldzka",
        "homeNumber": "51"
    },
    {
        "id": 2,
        "email": "aDudek@wp.pl",
        "firstName": "Adam",
        "lastName": "Dudek",
        "city": "Warszawa",
        "postalCode": "00-000",
        "street": "Marszalkowska",
        "homeNumber": "511"
    }
]
  ```
  
##### GET /userData/[id]

Example: http://localhost:8080/userData/1

Response body:

```
{
    "id": 1,
    "email": "sebastian@wp.pl",
    "firstName": "Sebastian",
    "lastName": "Kasa",
    "city": "Gdansk",
    "postalCode": "80-000",
    "street": "Grunwaldzka",
    "homeNumber": "51"
}
  ```
  
##### POST /userData

Example: http://localhost:8080/userData

Request body:

```
{
    "id": null,
    "email": "sebastian@wp.pl",
    "firstName": "Sebastian",
    "lastName": "Kassowski",
    "city": "Gdansk",
    "postalCode": "80-000",
    "street": "Grunwaldzka",
    "homeNumber": "51"
}
```
  
##### PUT /userData

Example: http://localhost:8080/userData

Request body:

```
{
    "id": 3,
    "email": "sebastian@wp.pl",
    "firstName": "Sebastian",
    "lastName": "Kassowski",
    "city": "Gdansk",
    "postalCode": "80-000",
    "street": "Polna",
    "homeNumber": "1"
}
```
  
##### DELETE /userData

Example: http://localhost:8080/userData

Request body:

```
{
    "id": 3,
    "email": "sebastian@wp.pl",
    "firstName": "Sebastian",
    "lastName": "Kassowski",
    "city": "Gdansk",
    "postalCode": "80-000",
    "street": "Polna",
    "homeNumber": "1"
}
```
  
#### UserOrderData
Data about relations beetwen users and their orders.
  - [GET /userOrder](#get-userOrder)
  - [GET /userOrder/[id]](#get-userOrderid)
  - [POST /userOrder/userOrder](#post-userOrder)
  - [PUT /userOrder/userOrder](#put-userOrder)
  - [DELETE /userOrder/userOrder](#delete-userOrder)
  
##### GET /userOrder

Example: http://localhost:8080/userOrder

Response body:

```
[
    {
        "id": 1,
        "count": 1,
        "book": {
            "id": 1,
            "title": "Lalka",
            "author": "Bolesław Prus",
            "pagesCount": 600,
            "price": 29.99,
            "count": 100,
            "idUser": 1
        }
    },
    {
        "id": 2,
        "count": 1,
        "book": {
            "id": 1,
            "title": "Lalka",
            "author": "Bolesław Prus",
            "pagesCount": 600,
            "price": 29.99,
            "count": 100,
            "idUser": 1
        }
    }
]
```
  
##### GET /userOrder/[id]

Example: http://localhost:8080/userOrder/1

Response body:

```
{
        "id": 1,
        "count": 1,
        "book": {
            "id": 1,
            "title": "Lalka",
            "author": "Bolesław Prus",
            "pagesCount": 600,
            "price": 29.99,
            "count": 100,
            "idUser": 1
        }
    }
```
  
##### POST /userOrder

Post userOrder as a child of OrderData
  
##### PUT /userOrder

Put userOrder as a child of OrderData
  
##### DELETE /userOrder

Delete userOrder through deleting OrderData

### Technologies
- Java 8
- Spring Boot
- JPA/Hibernate
- SQL
- MySQL
- JUnit

## Setup
Requirements:
- Maven
- Java 8 or higher
- MySQL server
- Before run application there is required to create database
To build this project locally open project directory and run:
```
mvn package
```
To run program from Command Prompt run follow: 
```
java -jar target/prisonDBApp-1.0-SNAPSHOT.jar
```

## TODO
- frontend
